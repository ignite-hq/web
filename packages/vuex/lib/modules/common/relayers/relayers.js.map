{"version":3,"sources":["../../../../src/modules/common/relayers/relayers.js"],"names":["ibcRegistry","Registry","defaultRegistryTypes","MsgCreateClient","MsgUpdateClient","MsgConnectionOpenInit","MsgConnectionOpenTry","MsgConnectionOpenAck","MsgConnectionOpenConfirm","MsgChannelOpenInit","MsgChannelOpenTry","MsgChannelOpenAck","MsgChannelOpenConfirm","MsgRecvPacket","MsgAcknowledgement","MsgTimeout","MsgTransfer","getDefaultState","relayers","transientLog","msg","relayerLinks","state","namespaced","getters","getRelayer","name","find","x","getRelayers","getRelayerLink","chainFromChannel","channel","status","src","channelId","chainIdB","chainToChannel","dest","log","mutations","RESET_STATE","Object","assign","SET_RELAYERS","CREATE_RELAYER","relayer","LINK_RELAYER","link","linkDetails","relayerIndex","findIndex","CONNECT_RELAYER","channelDetails","RUN_RELAYER","running","STOP_RELAYER","SET_LOG_MSG","LAST_QUERIED_HEIGHTS","heights","actions","init","commit","rootGetters","dispatch","forEach","createRelayer","prefix","endpoint","gasPrice","chainId","external","DirectSecp256k1HdWallet","fromMnemonic","signerA","signerB","getAccounts","accountB","optionsA","GasPrice","fromString","registry","Tendermint34Client","connect","tmClientA","signingClientA","StarportSigningClient","getChainId","chainIdA","optionsB","tmClientB","signingClientB","targetAddress","address","root","loadRelayer","SpVuexError","accountA","info","error","warn","verbose","debug","logger","clientA","IbcClient","clientB","Link","createWithExistingConnections","endA","connectionID","endB","linkData","clientID","console","linkRelayer","createWithNewConnections","connectRelayer","relayerLink","createChannel","channels","channelData","runRelayer","options","poll","maxAgeDest","maxAgeSrc","stopRelayer","relayerLoop","nextRelay","checkAndRelayPacketsAndAcks","updateClientIfStale"],"mappings":"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","sourcesContent":["import StarportSigningClient from './lib/starportSigningClient'\nimport SpVuexError from '../../../errors/SpVuexError'\nimport { IbcClient, Link } from '@confio/relayer/build/main'\nimport { Registry, DirectSecp256k1HdWallet } from '@cosmjs/proto-signing'\nimport { stringToPath } from '@cosmjs/crypto'\nimport { sleep } from '@cosmjs/utils'\nimport { GasPrice } from '@cosmjs/launchpad'\nimport { defaultRegistryTypes } from '@cosmjs/stargate'\nimport { Tendermint34Client } from '@cosmjs/tendermint-rpc'\nimport { MsgTransfer } from '@confio/relayer/build/main/codec/ibc/applications/transfer/v1/tx'\nimport {\n\tMsgAcknowledgement,\n\tMsgChannelOpenAck,\n\tMsgChannelOpenConfirm,\n\tMsgChannelOpenInit,\n\tMsgChannelOpenTry,\n\tMsgRecvPacket,\n\tMsgTimeout\n} from '@confio/relayer/build/main/codec/ibc/core/channel/v1/tx'\nimport {\n\tMsgCreateClient,\n\tMsgUpdateClient\n} from '@confio/relayer/build/main/codec/ibc/core/client/v1/tx'\nimport {\n\tMsgConnectionOpenAck,\n\tMsgConnectionOpenConfirm,\n\tMsgConnectionOpenInit,\n\tMsgConnectionOpenTry\n} from '@confio/relayer/build/main/codec/ibc/core/connection/v1/tx'\n\nfunction ibcRegistry() {\n\treturn new Registry([\n\t\t...defaultRegistryTypes,\n\t\t['/ibc.core.client.v1.MsgCreateClient', MsgCreateClient],\n\t\t['/ibc.core.client.v1.MsgUpdateClient', MsgUpdateClient],\n\t\t['/ibc.core.connection.v1.MsgConnectionOpenInit', MsgConnectionOpenInit],\n\t\t['/ibc.core.connection.v1.MsgConnectionOpenTry', MsgConnectionOpenTry],\n\t\t['/ibc.core.connection.v1.MsgConnectionOpenAck', MsgConnectionOpenAck],\n\t\t[\n\t\t\t'/ibc.core.connection.v1.MsgConnectionOpenConfirm',\n\t\t\tMsgConnectionOpenConfirm\n\t\t],\n\t\t['/ibc.core.channel.v1.MsgChannelOpenInit', MsgChannelOpenInit],\n\t\t['/ibc.core.channel.v1.MsgChannelOpenTry', MsgChannelOpenTry],\n\t\t['/ibc.core.channel.v1.MsgChannelOpenAck', MsgChannelOpenAck],\n\t\t['/ibc.core.channel.v1.MsgChannelOpenConfirm', MsgChannelOpenConfirm],\n\t\t['/ibc.core.channel.v1.MsgRecvPacket', MsgRecvPacket],\n\t\t['/ibc.core.channel.v1.MsgAcknowledgement', MsgAcknowledgement],\n\t\t['/ibc.core.channel.v1.MsgTimeout', MsgTimeout],\n\t\t['/ibc.applications.transfer.v1.MsgTransfer', MsgTransfer]\n\t])\n}\nconst getDefaultState = () => {\n\treturn {\n\t\trelayers: [],\n\t\ttransientLog: {\n\t\t\tmsg: ''\n\t\t},\n\t\trelayerLinks: {}\n\t}\n}\n// initial state\nconst state = getDefaultState()\nexport default {\n\tnamespaced: true,\n\tstate,\n\tgetters: {\n\t\tgetRelayer: (state) => (name) => {\n\t\t\treturn state.relayers.find((x) => x.name == name)\n\t\t},\n\t\tgetRelayers: (state) => state.relayers,\n\t\tgetRelayerLink: (state) => (name) => {\n\t\t\treturn state.relayerLinks[name]\n\t\t},\n\t\tchainFromChannel: (state) => (channel) => {\n\t\t\treturn (\n\t\t\t\tstate.relayers.find(\n\t\t\t\t\t(x) => x.status == 'connected' && x.src.channelId == channel\n\t\t\t\t)?.chainIdB ?? channel\n\t\t\t)\n\t\t},\n\t\tchainToChannel: (state) => (channel) => {\n\t\t\treturn (\n\t\t\t\tstate.relayers.find(\n\t\t\t\t\t(x) => x.status == 'connected' && x.dest.channelId == channel\n\t\t\t\t)?.chainIdB ?? channel\n\t\t\t)\n\t\t},\n\t\tlog: (state) => state.transientLog.msg\n\t},\n\tmutations: {\n\t\tRESET_STATE(state) {\n\t\t\tObject.assign(state, getDefaultState())\n\t\t},\n\t\tSET_RELAYERS(state, relayers) {\n\t\t\tstate.relayers = relayers\n\t\t},\n\t\tCREATE_RELAYER(state, relayer) {\n\t\t\tstate.relayers = [...state.relayers, relayer]\n\t\t},\n\t\tLINK_RELAYER(state, { name, link, ...linkDetails }) {\n\t\t\tlet relayerIndex = state.relayers.findIndex((x) => x.name == name)\n\t\t\tif (state.relayers[relayerIndex].status == 'connected') {\n\t\t\t\tstate.relayers[relayerIndex] = {\n\t\t\t\t\t...state.relayers[relayerIndex],\n\t\t\t\t\t...linkDetails,\n\t\t\t\t\tstatus: 'connected'\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tstate.relayers[relayerIndex] = {\n\t\t\t\t\t...state.relayers[relayerIndex],\n\t\t\t\t\t...linkDetails,\n\t\t\t\t\tstatus: 'linked'\n\t\t\t\t}\n\t\t\t}\n\t\t\tstate.relayerLinks[name] = link\n\t\t},\n\t\tCONNECT_RELAYER(state, { name, ...channelDetails }) {\n\t\t\tlet relayerIndex = state.relayers.findIndex((x) => x.name == name)\n\t\t\tstate.relayers[relayerIndex] = {\n\t\t\t\t...state.relayers[relayerIndex],\n\t\t\t\t...channelDetails,\n\t\t\t\tstatus: 'connected'\n\t\t\t}\n\t\t},\n\t\tRUN_RELAYER(state, name) {\n\t\t\tstate.relayers.find((x) => x.name == name).running = true\n\t\t},\n\t\tSTOP_RELAYER(state, name) {\n\t\t\tstate.relayers.find((x) => x.name == name).running = false\n\t\t},\n\t\tSET_LOG_MSG(state, msg) {\n\t\t\tstate.transientLog.msg = msg\n\t\t},\n\t\tLAST_QUERIED_HEIGHTS(state, { name, heights }) {\n\t\t\tstate.relayers.find((x) => x.name == name).heights = heights\n\t\t}\n\t},\n\tactions: {\n\t\tinit({ commit, rootGetters, dispatch }) {\n\t\t\tcommit('RESET_STATE')\n\t\t\tconst relayers = rootGetters['common/wallet/relayers']\n\t\t\tcommit('SET_RELAYERS', relayers)\n\t\t\trelayers.forEach((relayer) => {\n\t\t\t\tif (relayer.status == 'linked' || relayer.status == 'connected') {\n\t\t\t\t\tdispatch('loadRelayer', relayer.name)\n\t\t\t\t}\n\t\t\t})\n\t\t},\n\t\tasync createRelayer(\n\t\t\t{ commit, rootGetters, getters, dispatch },\n\t\t\t{ name, prefix, endpoint, gasPrice, chainId, channelId, external }\n\t\t) {\n\t\t\tlet relayer\n\t\t\tif (!external) {\n\t\t\t\trelayer = {\n\t\t\t\t\tname,\n\t\t\t\t\tprefix,\n\t\t\t\t\tendpoint,\n\t\t\t\t\tgasPrice,\n\t\t\t\t\texternal: false,\n\t\t\t\t\tstatus: 'created',\n\t\t\t\t\theights: {},\n\t\t\t\t\trunning: false\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\trelayer = {\n\t\t\t\t\tname,\n\t\t\t\t\texternal: true,\n\t\t\t\t\tstatus: 'connected',\n\t\t\t\t\tchainIdB: chainId,\n\t\t\t\t\tsrc: {\n\t\t\t\t\t\tchannelId: channelId\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (!external) {\n\t\t\t\tconst signerA = await DirectSecp256k1HdWallet.fromMnemonic(\n\t\t\t\t\trootGetters['common/wallet/getMnemonic'],\n\t\t\t\t\tstringToPath(rootGetters['common/wallet/getPath']),\n\t\t\t\t\trootGetters['common/env/addrPrefix']\n\t\t\t\t)\n\t\t\t\tconst signerB = await DirectSecp256k1HdWallet.fromMnemonic(\n\t\t\t\t\trootGetters['common/wallet/getMnemonic'],\n\t\t\t\t\tstringToPath(rootGetters['common/wallet/getPath']),\n\t\t\t\t\trelayer.prefix\n\t\t\t\t)\t\t\t\t\n\t\t\t\tconst [accountB] = await signerB.getAccounts()\n\t\t\t\tconst optionsA = {\n\t\t\t\t\tprefix: rootGetters['common/env/addrPrefix'],\n\t\t\t\t\tgasPrice: GasPrice.fromString(rootGetters['common/wallet/gasPrice']),\n\t\t\t\t\tregistry: ibcRegistry()\n\t\t\t\t}\n\t\t\t\tconst tmClientA = await Tendermint34Client.connect(\n\t\t\t\t\trootGetters['common/env/apiTendermint']\n\t\t\t\t)\n\t\t\t\tconst signingClientA = new StarportSigningClient(\n\t\t\t\t\ttmClientA,\n\t\t\t\t\tsignerA,\n\t\t\t\t\toptionsA\n\t\t\t\t)\n\t\t\t\trelayer.chainIdA = await signingClientA.getChainId()\n\t\t\t\tconst optionsB = {\n\t\t\t\t\tprefix: relayer.prefix,\n\t\t\t\t\tgasPrice: GasPrice.fromString(relayer.gasPrice),\n\t\t\t\t\tregistry: ibcRegistry()\n\t\t\t\t}\n\t\t\t\tconst tmClientB = await Tendermint34Client.connect(relayer.endpoint)\n\t\t\t\tconst signingClientB = new StarportSigningClient(\n\t\t\t\t\ttmClientB,\n\t\t\t\t\tsignerB,\n\t\t\t\t\toptionsB\n\t\t\t\t)\n\t\t\t\trelayer.chainIdB = await signingClientB.getChainId()\n\t\t\t\trelayer.targetAddress = accountB.address\n\t\t\t}\n\t\t\tcommit('CREATE_RELAYER', relayer)\n\t\t\tdispatch('common/wallet/updateRelayers', getters['getRelayers'], {\n\t\t\t\troot: true\n\t\t\t})\n\t\t},\n\t\tasync loadRelayer({ commit, rootGetters, getters, dispatch }, name) {\n\t\t\tconst relayer = getters['getRelayer'](name)\n\t\t\tif (relayer.status !== 'linked' && relayer.status !== 'connected') {\n\t\t\t\tthrow new SpVuexError(\n\t\t\t\t\t'relayers:connectRelayer',\n\t\t\t\t\t'Relayer already connected.'\n\t\t\t\t)\n\t\t\t}\n\t\t\ttry {\n\t\t\t\tconst signerA = await DirectSecp256k1HdWallet.fromMnemonic(\n\t\t\t\t\trootGetters['common/wallet/getMnemonic'],\n\t\t\t\t\tstringToPath(rootGetters['common/wallet/getPath']),\n\t\t\t\t\trootGetters['common/env/addrPrefix']\n\t\t\t\t)\n\t\t\t\tconst signerB = await DirectSecp256k1HdWallet.fromMnemonic(\n\t\t\t\t\trootGetters['common/wallet/getMnemonic'],\n\t\t\t\t\tstringToPath(rootGetters['common/wallet/getPath']),\n\t\t\t\t\trelayer.prefix\n\t\t\t\t)\n\t\t\t\tconst [accountA] = await signerA.getAccounts()\n\t\t\t\tconst [accountB] = await signerB.getAccounts()\n\t\t\t\tconst transientLog = {\n\t\t\t\t\tlog: (msg) => {\n\t\t\t\t\t\tcommit('SET_LOG_MSG', msg)\n\t\t\t\t\t},\n\t\t\t\t\tinfo: (msg) => {\n\t\t\t\t\t\tcommit('SET_LOG_MSG', msg)\n\t\t\t\t\t},\n\t\t\t\t\terror: (msg) => {\n\t\t\t\t\t\tcommit('SET_LOG_MSG', msg)\n\t\t\t\t\t},\n\t\t\t\t\twarn: (msg) => {\n\t\t\t\t\t\tcommit('SET_LOG_MSG', msg)\n\t\t\t\t\t},\n\t\t\t\t\tverbose: (msg) => {\n\t\t\t\t\t\tcommit('SET_LOG_MSG', msg)\n\t\t\t\t\t},\n\t\t\t\t\tdebug: () => {\n\t\t\t\t\t\t//commit('SET_LOG_MSG',msg)\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tconst optionsA = {\n\t\t\t\t\tprefix: rootGetters['common/env/addrPrefix'],\n\t\t\t\t\tlogger: transientLog,\n\t\t\t\t\tgasPrice: GasPrice.fromString(rootGetters['common/wallet/gasPrice']),\n\t\t\t\t\tregistry: ibcRegistry()\n\t\t\t\t}\n\t\t\t\tconst tmClientA = await Tendermint34Client.connect(\n\t\t\t\t\trootGetters['common/env/apiTendermint']\n\t\t\t\t)\n\t\t\t\tconst signingClientA = new StarportSigningClient(\n\t\t\t\t\ttmClientA,\n\t\t\t\t\tsignerA,\n\t\t\t\t\toptionsA\n\t\t\t\t)\n\t\t\t\tconst chainIdA = await signingClientA.getChainId()\n\t\t\t\tconst optionsB = {\n\t\t\t\t\tprefix: relayer.prefix,\n\t\t\t\t\tlogger: transientLog,\n\t\t\t\t\tgasPrice: GasPrice.fromString(relayer.gasPrice),\n\t\t\t\t\tregistry: ibcRegistry()\n\t\t\t\t}\n\t\t\t\tconst tmClientB = await Tendermint34Client.connect(relayer.endpoint)\n\t\t\t\tconst signingClientB = new StarportSigningClient(\n\t\t\t\t\ttmClientB,\n\t\t\t\t\tsignerB,\n\t\t\t\t\toptionsB\n\t\t\t\t)\n\t\t\t\tconst chainIdB = await signingClientB.getChainId()\n\n\t\t\t\tlet clientA = new IbcClient(\n\t\t\t\t\tsigningClientA,\n\t\t\t\t\ttmClientA,\n\t\t\t\t\taccountA.address,\n\t\t\t\t\tchainIdA,\n\t\t\t\t\toptionsA\n\t\t\t\t)\n\t\t\t\tlet clientB = new IbcClient(\n\t\t\t\t\tsigningClientB,\n\t\t\t\t\ttmClientB,\n\t\t\t\t\taccountB.address,\n\t\t\t\t\tchainIdB,\n\t\t\t\t\toptionsB\n\t\t\t\t)\n\t\t\t\tconst link = await Link.createWithExistingConnections(\n\t\t\t\t\tclientA,\n\t\t\t\t\tclientB,\n\t\t\t\t\trelayer.endA.connectionID,\n\t\t\t\t\trelayer.endB.connectionID\n\t\t\t\t)\n\t\t\t\tconst linkData = {\n\t\t\t\t\tname,\n\t\t\t\t\tlink,\n\t\t\t\t\tchainIdA,\n\t\t\t\t\tchainIdB,\n\t\t\t\t\tendA: {\n\t\t\t\t\t\tclientID: link.endA.clientID,\n\t\t\t\t\t\tconnectionID: link.endA.connectionID\n\t\t\t\t\t},\n\t\t\t\t\tendB: {\n\t\t\t\t\t\tclientID: link.endB.clientID,\n\t\t\t\t\t\tconnectionID: link.endB.connectionID\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tcommit('LINK_RELAYER', linkData)\n\t\t\t\tdispatch('common/wallet/updateRelayers', getters['getRelayers'], {\n\t\t\t\t\troot: true\n\t\t\t\t})\n\t\t\t\tif (relayer.status != 'connected') {\n\t\t\t\t\tawait dispatch('connectRelayer', relayer.name)\n\t\t\t\t} else {\n\t\t\t\t\tif (relayer.running) {\n\t\t\t\t\t\tdispatch('runRelayer', relayer.name)\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} catch (e) {\n\t\t\t\tconsole.error(e)\n\t\t\t}\n\t\t},\n\t\tasync linkRelayer({ commit, rootGetters, getters, dispatch }, { name }) {\n\t\t\tconst relayer = getters['getRelayer'](name)\n\t\t\tif (relayer.status !== 'created') {\n\t\t\t\tthrow new SpVuexError(\n\t\t\t\t\t'relayers:connectRelayer',\n\t\t\t\t\t'Relayer already connected.'\n\t\t\t\t)\n\t\t\t}\n\t\t\ttry {\n\t\t\t\tconst signerA = await DirectSecp256k1HdWallet.fromMnemonic(\n\t\t\t\t\trootGetters['common/wallet/getMnemonic'],\n\t\t\t\t\tstringToPath(rootGetters['common/wallet/getPath']),\n\t\t\t\t\trootGetters['common/env/addrPrefix']\n\t\t\t\t)\n\t\t\t\tconst signerB = await DirectSecp256k1HdWallet.fromMnemonic(\n\t\t\t\t\trootGetters['common/wallet/getMnemonic'],\n\t\t\t\t\tstringToPath(rootGetters['common/wallet/getPath']),\n\t\t\t\t\trelayer.prefix\n\t\t\t\t)\n\t\t\t\tconst [accountA] = await signerA.getAccounts()\n\t\t\t\tconst [accountB] = await signerB.getAccounts()\n\t\t\t\tconst transientLog = {\n\t\t\t\t\tlog: (msg) => {\n\t\t\t\t\t\tcommit('SET_LOG_MSG', msg)\n\t\t\t\t\t},\n\t\t\t\t\tinfo: (msg) => {\n\t\t\t\t\t\tcommit('SET_LOG_MSG', msg)\n\t\t\t\t\t},\n\t\t\t\t\terror: (msg) => {\n\t\t\t\t\t\tcommit('SET_LOG_MSG', msg)\n\t\t\t\t\t},\n\t\t\t\t\twarn: (msg) => {\n\t\t\t\t\t\tcommit('SET_LOG_MSG', msg)\n\t\t\t\t\t},\n\t\t\t\t\tverbose: (msg) => {\n\t\t\t\t\t\tcommit('SET_LOG_MSG', msg)\n\t\t\t\t\t},\n\t\t\t\t\tdebug: () => {\n\t\t\t\t\t\t//commit('SET_LOG_MSG',msg)\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tconst optionsA = {\n\t\t\t\t\tprefix: rootGetters['common/env/addrPrefix'],\n\t\t\t\t\tlogger: transientLog,\n\t\t\t\t\tgasPrice: GasPrice.fromString(rootGetters['common/wallet/gasPrice']),\n\t\t\t\t\tregistry: ibcRegistry()\n\t\t\t\t}\n\t\t\t\tconst tmClientA = await Tendermint34Client.connect(\n\t\t\t\t\trootGetters['common/env/apiTendermint']\n\t\t\t\t)\n\t\t\t\tconst signingClientA = new StarportSigningClient(\n\t\t\t\t\ttmClientA,\n\t\t\t\t\tsignerA,\n\t\t\t\t\toptionsA\n\t\t\t\t)\n\t\t\t\tconst chainIdA = await signingClientA.getChainId()\n\t\t\t\tconst optionsB = {\n\t\t\t\t\tprefix: relayer.prefix,\n\t\t\t\t\tlogger: transientLog,\n\t\t\t\t\tgasPrice: GasPrice.fromString(relayer.gasPrice),\n\t\t\t\t\tregistry: ibcRegistry()\n\t\t\t\t}\n\t\t\t\tconst tmClientB = await Tendermint34Client.connect(relayer.endpoint)\n\t\t\t\tconst signingClientB = new StarportSigningClient(\n\t\t\t\t\ttmClientB,\n\t\t\t\t\tsignerB,\n\t\t\t\t\toptionsB\n\t\t\t\t)\n\t\t\t\tconst chainIdB = await signingClientB.getChainId()\n\n\t\t\t\tlet clientA = new IbcClient(\n\t\t\t\t\tsigningClientA,\n\t\t\t\t\ttmClientA,\n\t\t\t\t\taccountA.address,\n\t\t\t\t\tchainIdA,\n\t\t\t\t\toptionsA\n\t\t\t\t)\n\t\t\t\tlet clientB = new IbcClient(\n\t\t\t\t\tsigningClientB,\n\t\t\t\t\ttmClientB,\n\t\t\t\t\taccountB.address,\n\t\t\t\t\tchainIdB,\n\t\t\t\t\toptionsB\n\t\t\t\t)\n\t\t\t\tconst link = await Link.createWithNewConnections(clientA, clientB)\n\t\t\t\tconst linkData = {\n\t\t\t\t\tname,\n\t\t\t\t\tlink,\n\t\t\t\t\tchainIdA,\n\t\t\t\t\tchainIdB,\n\t\t\t\t\tendA: {\n\t\t\t\t\t\tclientID: link.endA.clientID,\n\t\t\t\t\t\tconnectionID: link.endA.connectionID\n\t\t\t\t\t},\n\t\t\t\t\tendB: {\n\t\t\t\t\t\tclientID: link.endB.clientID,\n\t\t\t\t\t\tconnectionID: link.endB.connectionID\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tcommit('LINK_RELAYER', linkData)\n\t\t\t\tdispatch('common/wallet/updateRelayers', getters['getRelayers'], {\n\t\t\t\t\troot: true\n\t\t\t\t})\n\t\t\t\tawait dispatch('connectRelayer', name)\n\t\t\t} catch (e) {\n\t\t\t\tconsole.error(e)\n\t\t\t}\n\t\t},\n\t\tasync connectRelayer({ commit, getters, dispatch }, name) {\n\t\t\tconst relayerLink = getters['getRelayerLink'](name)\n\t\t\tconst channels = await relayerLink.createChannel(\n\t\t\t\t'A',\n\t\t\t\t'transfer',\n\t\t\t\t'transfer',\n\t\t\t\t1,\n\t\t\t\t'ics20-1'\n\t\t\t)\n\t\t\tconst channelData = {\n\t\t\t\tname,\n\t\t\t\t...channels\n\t\t\t}\n\t\t\tcommit('CONNECT_RELAYER', channelData)\n\t\t\tdispatch('common/wallet/updateRelayers', getters['getRelayers'], {\n\t\t\t\troot: true\n\t\t\t})\n\t\t\tdispatch('runRelayer', name)\n\t\t},\n\t\tasync runRelayer({ commit, getters, dispatch }, name) {\n\t\t\tconst relayerLink = getters['getRelayerLink'](name)\n\t\t\tcommit('RUN_RELAYER', name)\n\t\t\tdispatch('common/wallet/updateRelayers', getters['getRelayers'], {\n\t\t\t\troot: true\n\t\t\t})\n\t\t\tdispatch('relayerLoop', {\n\t\t\t\tname,\n\t\t\t\tlink: relayerLink,\n\t\t\t\toptions: { poll: 1, maxAgeDest: 86400, maxAgeSrc: 86400 }\n\t\t\t})\n\t\t},\n\t\tasync stopRelayer({ commit }, name) {\n\t\t\tcommit('STOP_RELAYER', name)\n\t\t},\n\t\tasync relayerLoop({ getters, commit, dispatch }, { name, link, options }) {\n\t\t\tlet relayer = getters['getRelayer'](name)\n\t\t\tlet nextRelay = relayer.heights ?? {}\n\t\t\twhile (getters['getRelayer'](name).running) {\n\t\t\t\ttry {\n\t\t\t\t\t// TODO: make timeout windows more configurable\n\t\t\t\t\tnextRelay = await link.checkAndRelayPacketsAndAcks(nextRelay, 2, 6)\n\t\t\t\t\tcommit('LAST_QUERIED_HEIGHTS', { name, heights: nextRelay })\n\t\t\t\t\tdispatch('common/wallet/updateRelayers', getters['getRelayers'], {\n\t\t\t\t\t\troot: true\n\t\t\t\t\t})\n\t\t\t\t\tawait link.updateClientIfStale('A', options.maxAgeDest)\n\t\t\t\t\tawait link.updateClientIfStale('B', options.maxAgeSrc)\n\t\t\t\t} catch (e) {\n\t\t\t\t\tconsole.error(`Caught error: `, e)\n\t\t\t\t}\n\t\t\t\tawait sleep(options.poll * 1000)\n\t\t\t}\n\t\t}\n\t}\n}\n"],"file":"relayers.js"}